@using PagedList.Mvc

@model PagedList.IPagedList<NauAnUtLanh.Database.FoodMenu>

@{
    ViewBag.Title = "Danh sách thực đơn có sẵn";
}

<h2>@ViewBag.Title</h2>
<hr/>
<p>@Html.ActionLink("Tạo thực đơn mới", "create")</p>

<table class="table table-hover">
    <tr>
        <th>Tên thực đơn</th>
        <th>Hình ảnh</th>
        <th>Giá</th>
        <th>Tình trạng</th>
        <th></th>
    </tr>
    @foreach (var menu in Model)
    {
        <tr>
            <td><strong class="text-primary">@menu.MenuName</strong></td>
            <td>
                @{
                    if (string.IsNullOrEmpty(menu.Avatar))
                    {
                        <img src="@Url.Content("~/images/photo-icon.png")" class="product-icon" alt="@menu.MenuName"/>
                    }
                    else
                    {
                        <img src="@Url.Content($"~/upload/foodmenu/{menu.Avatar}")" class="product-icon" alt="@menu.MenuName"/>
                    }
                }
            </td>
            <td><strong class="text-danger">@($"{menu.Price:0,0}")</strong></td>
            <td>
                @{
                    if (menu.Activated)
                    {
                        <a href="#" onclick="return changeStatus('@menu.Id')">
                            <img src="@Url.Content("~/images/activated-icon.png")" class="menu-icon" alt="Đang hiển thị" title="Đang hiển thị"/>
                        </a>

                    }
                    else
                    {
                        <a href="#" onclick="return changeStatus('@menu.Id')">
                            <img src="@Url.Content("~/images/inactive-icon.png")" class="menu-icon" alt="Tạm ẩn" title="Tạm ẩn"/>
                        </a>
                    }
                    if (menu.Feature)
                    {
                        <a href="#" onclick="return changeFeature('@menu.Id')">
                            <img src="@Url.Content("~/images/show-home-icon.png")" class="menu-icon" alt="Hiển thị trên trang chủ" title="Hiển thị trên trang chủ" />
                        </a>

                    }
                    else
                    {
                        <a href="#" onclick="return changeFeature('@menu.Id')">
                            <img src="@Url.Content("~/images/inactive-icon.png")" class="menu-icon" alt="Không hiển thị trên trang chủ" title="Không hiển thị trên trang chủ" />
                        </a>
                    }
                }
            </td>
            <td>
                @Html.ActionLink("Chi tiết", "details", new {id = menu.Id} ) |
                @Html.ActionLink("Thay đổi", "edit", new { id = menu.Id }) |
                <a href="#" onclick="deleteMenu('@menu.Id')">Xóa</a>
            </td>
        </tr>
    }
</table>
<!-- Danh sách thực đơn tại đây -->

@Html.PagedListPager(Model, page => Url.Action("index", new { page }))

@section Scripts{
    @Scripts.Render("~/bundles/jqueryval")
    <script>
        function changeStatus(id) {
            $.ajax({
                url: '@Url.Action("changestatus")',
                data: { id: id },
                error: function () {
                    alert('Can not retrieve data');
                },
                dataType: 'text',
                success: function () {
                    location.reload();
                },
                type: 'POST'
            });
        }
        function changeFeature(id) {
            $.ajax({
                url: '@Url.Action("changefeature")',
                data: { id: id },
                error: function () {
                    alert('Can not retrieve data');
                },
                dataType: 'text',
                success: function () {
                    location.reload();
                },
                type: 'POST'
            });
        }
        function deleteMenu(id) {
            $.confirm({
                title: 'Cảnh báo!!!',
                content: 'Bạn chắc chắn muốn xóa?',
                buttons: {
                    confirm: function () {
                        $.ajax({
                            url: '@Url.Action("Delete")',
                            data: { id },
                            error: function () {
                                alert('Can not retrieve data');
                            },
                            dataType: 'text',
                            success: function () {
                                location.reload();
                            },
                            type: 'POST'
                        });
                    },
                    cancel: function () {
                        return;
                    }
                }
            });
        }
    </script>
}
